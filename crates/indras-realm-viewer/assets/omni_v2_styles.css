/* =============================================================================
   Omni V2 - Live Multi-Screen Dashboard Stylesheet
   Mission control: each column is a live viewport into one member's screen.
   ============================================================================= */

/* =============================================================================
   V2 DASHBOARD - CSS Grid Layout
   ============================================================================= */

.v2-dashboard {
  display: grid;
  grid-template-columns: repeat(var(--omni-columns, 3), 1fr);
  height: 100vh;
  padding-bottom: 80px; /* clearance for FloatingControlBar */
  overflow: hidden;
  background: var(--bg-primary);
}

.v2-empty {
  grid-column: 1 / -1;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.v2-empty-text {
  font-size: var(--font-size-base);
  color: var(--text-muted);
  font-style: italic;
}

/* =============================================================================
   MEMBER COLUMN - Individual viewport
   Left-border accent (3px member color), flex column layout
   ============================================================================= */

.member-column {
  position: relative;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border-primary);
  border-left: 3px solid var(--member-color, var(--accent-primary));
  overflow: hidden;
  min-width: 0;
  background: var(--bg-primary);
  transition: opacity 0.6s ease;
}

.member-column:last-child {
  border-right: none;
}

/* Idle state: column dims to 60% opacity */
.member-column.column-idle {
  opacity: 0.6;
}

/* =============================================================================
   COLUMN HEADER - Identity bar
   ============================================================================= */

.column-header {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-primary);
}

.v2-avatar {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-xs);
  font-weight: 700;
  color: var(--bg-primary);
  flex-shrink: 0;
  background: var(--accent-primary);
}

/* Avatar member color classes */
.v2-avatar.member-love { background: var(--color-love); }
.v2-avatar.member-joy { background: var(--color-joy); color: #1a1a1a; }
.v2-avatar.member-peace { background: var(--color-peace); color: #1a1a1a; }
.v2-avatar.member-grace { background: var(--color-grace); }
.v2-avatar.member-hope { background: var(--color-hope); color: #1a1a1a; }
.v2-avatar.member-faith { background: var(--color-faith); color: #1a1a1a; }

.identity-name {
  font-size: var(--font-size-sm);
  font-weight: 700;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.identity-recency {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  flex-shrink: 0;
  margin-left: auto;
}

/* =============================================================================
   COLUMN NAV - Bottom tab bar (Design System: nav pattern)
   Lucide stroke icons + mono labels, minimal terminal aesthetic
   ============================================================================= */

.column-nav {
  flex-shrink: 0;
  display: flex;
  gap: var(--space-1, 4px);
  padding: var(--space-2, 8px) var(--space-3, 12px);
  background: var(--bg-secondary, #0a0e0f);
  border-top: 1px solid var(--border-primary, #1a1a1a);
}

.screen-tab {
  flex: 1 1 0%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1, 4px);
  padding: var(--space-2, 8px) var(--space-1, 4px);
  color: var(--text-muted, rgba(245, 245, 245, 0.5));
  border-radius: 4px;
  cursor: default;
  transition: color 150ms ease, background 150ms ease;
}

.screen-tab.tab-active {
  color: var(--member-color, var(--accent-primary));
  background: color-mix(in srgb, var(--member-color, var(--accent-primary)) 10%, transparent);
}

.tab-icon {
  flex-shrink: 0;
}

.tab-label {
  font-family: var(--font-mono);
  font-size: 10px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}


/* =============================================================================
   COLUMN BODY - Scrollable content area
   ============================================================================= */

.column-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-3);
  /* Screen content slides in from right on change */
  animation: screen-slide-in 0.2s ease-out;
}

@keyframes screen-slide-in {
  from { transform: translateX(12px); opacity: 0.7; }
  to   { transform: translateX(0); opacity: 1; }
}

/* Thin scrollbars */
.column-body::-webkit-scrollbar {
  width: 4px;
}

.column-body::-webkit-scrollbar-track {
  background: transparent;
}

.column-body::-webkit-scrollbar-thumb {
  background: var(--border-primary);
  border-radius: 2px;
}

/* =============================================================================
   COLUMN FOOTER - Persistent activity tail
   ============================================================================= */

.column-footer {
  flex-shrink: 0;
  border-top: 1px solid var(--border-primary);
  background: var(--bg-secondary);
  padding: var(--space-2) var(--space-3);
  display: flex;
  flex-direction: column;
  gap: 2px;
  max-height: 90px;
  overflow-y: auto;
}

.column-footer::-webkit-scrollbar {
  width: 3px;
}

.column-footer::-webkit-scrollbar-track {
  background: transparent;
}

.column-footer::-webkit-scrollbar-thumb {
  background: var(--border-subtle);
  border-radius: 2px;
}

.footer-activity-line {
  display: flex;
  align-items: baseline;
  gap: var(--space-1);
  font-size: 10px;
  line-height: 1.3;
}

.footer-activity-tick {
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.footer-activity-text {
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* =============================================================================
   SHARED MINI-SCREEN STYLES
   ============================================================================= */

.mini-section-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: var(--space-2);
}

.mini-subsection-label {
  font-size: 9px;
  font-weight: 600;
  color: var(--text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: var(--space-1);
  margin-top: var(--space-2);
}

.mini-empty {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  font-style: italic;
  padding: var(--space-2) 0;
}

.mini-stat {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-secondary);
  background: var(--bg-tertiary);
  padding: 1px 5px;
  border-radius: var(--radius-sm);
}

.mini-stat-accent {
  color: var(--accent-primary);
}

/* =============================================================================
   MINI HOME SCREEN
   ============================================================================= */

.mini-home {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-4) 0;
}

.mini-home-profile {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
}

.mini-home-avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-xl, 20px);
  font-weight: 700;
  color: var(--bg-primary);
  background: var(--accent-primary);
}

/* Avatar member color classes for mini home */
.mini-home-avatar.member-love { background: var(--color-love); }
.mini-home-avatar.member-joy { background: var(--color-joy); color: #1a1a1a; }
.mini-home-avatar.member-peace { background: var(--color-peace); color: #1a1a1a; }
.mini-home-avatar.member-grace { background: var(--color-grace); }
.mini-home-avatar.member-hope { background: var(--color-hope); color: #1a1a1a; }
.mini-home-avatar.member-faith { background: var(--color-faith); color: #1a1a1a; }

.mini-home-name {
  font-size: var(--font-size-base);
  font-weight: 700;
  color: var(--text-primary);
}

.mini-home-focus {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: var(--space-1) var(--space-3);
  background: color-mix(in srgb, var(--accent-primary) 8%, transparent);
  border-radius: var(--radius-pill);
}

.mini-home-focus-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-primary);
  flex-shrink: 0;
  animation: home-focus-pulse 2s ease-in-out infinite;
}

@keyframes home-focus-pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.mini-home-focus-text {
  font-size: var(--font-size-xs);
  color: var(--accent-primary);
  font-weight: 500;
}

.mini-home-stats {
  display: flex;
  gap: var(--space-1);
}

/* =============================================================================
   MINI QUEST SCREEN
   ============================================================================= */

.mini-quest {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.mini-quest-item {
  padding: var(--space-1) 0;
}

.mini-quest-item.quest-focusing {
  position: relative;
}

.mini-quest-item.quest-focusing .mini-quest-title {
  color: var(--text-primary);
  font-weight: 600;
}

.mini-quest-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-1);
  margin-bottom: 2px;
}

.mini-quest-title {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.mini-quest-status {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.mini-quest-bar-row {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.mini-quest-bar {
  flex: 1;
  height: 6px;
  background: var(--bg-tertiary);
  border-radius: 3px;
  overflow: hidden;
}

.mini-quest-bar-fill {
  height: 100%;
  background: var(--member-color, var(--accent-primary));
  border-radius: 3px;
  transition: width var(--transition-base);
}

.quest-focusing .mini-quest-bar-fill {
  box-shadow: 0 0 6px color-mix(in srgb, var(--member-color, var(--accent-primary)) 50%, transparent);
}

.mini-quest-time {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  min-width: 28px;
  text-align: right;
}

.mini-quest-focus-badge {
  font-size: 9px;
  font-weight: 700;
  color: var(--accent-primary);
  background: color-mix(in srgb, var(--accent-primary) 12%, transparent);
  padding: 0 4px;
  border-radius: var(--radius-sm);
  letter-spacing: 0.05em;
  flex-shrink: 0;
}

/* =============================================================================
   MINI CHAT SCREEN
   ============================================================================= */

.mini-chat {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.mini-chat-msg {
  display: flex;
  gap: var(--space-1);
  font-size: var(--font-size-xs);
  line-height: 1.4;
  padding: 2px 0;
}

.mini-chat-sender {
  font-weight: 600;
  flex-shrink: 0;
  color: var(--text-secondary);
}

/* Sender color classes */
.mini-chat-sender.member-love { color: var(--color-love); }
.mini-chat-sender.member-joy { color: var(--color-joy); }
.mini-chat-sender.member-peace { color: var(--color-peace); }
.mini-chat-sender.member-grace { color: var(--color-grace); }
.mini-chat-sender.member-hope { color: var(--color-hope); }
.mini-chat-sender.member-faith { color: var(--color-faith); }

.mini-chat-text {
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

/* =============================================================================
   MINI PROOF SCREEN
   ============================================================================= */

.mini-proof {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.mini-proof-indicator {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--font-size-xs);
  color: var(--accent-primary);
  font-weight: 500;
}

.mini-proof-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-primary);
  animation: proof-pulse 1.5s ease-in-out infinite;
}

@keyframes proof-pulse {
  0%, 100% { opacity: 0.4; transform: scale(0.9); }
  50% { opacity: 1; transform: scale(1.1); }
}

.mini-proof-events {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.mini-proof-event {
  display: flex;
  align-items: baseline;
  gap: var(--space-1);
  font-size: 10px;
  line-height: 1.4;
}

.mini-proof-tick {
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.mini-proof-text {
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.mini-proof-tokens {
  border-top: 1px solid var(--border-subtle);
  padding-top: var(--space-2);
}

.mini-proof-token {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  font-size: var(--font-size-xs);
  padding: 2px 0;
}

.mini-proof-quest {
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.mini-proof-badge {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  background: var(--bg-tertiary);
  padding: 1px 4px;
  border-radius: var(--radius-sm);
  flex-shrink: 0;
}

/* =============================================================================
   MINI ARTIFACT SCREEN
   ============================================================================= */

.mini-artifact {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.mini-artifact-row {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--font-size-xs);
  padding: 2px 0;
}

.mini-artifact-icon {
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  flex-shrink: 0;
  font-size: 10px;
}

.mini-artifact-name {
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.mini-artifact-sharer {
  font-size: 10px;
  color: var(--text-muted);
  flex-shrink: 0;
}

.mini-artifact-status {
  font-size: 9px;
  font-family: var(--font-mono);
  padding: 0 4px;
  border-radius: var(--radius-sm);
  flex-shrink: 0;
}

.mini-artifact-status.status-shared {
  color: var(--color-success, #4ade80);
  background: color-mix(in srgb, var(--color-success, #4ade80) 10%, transparent);
}

.mini-artifact-status.status-recalled {
  color: var(--color-warning, #fbbf24);
  background: color-mix(in srgb, var(--color-warning, #fbbf24) 10%, transparent);
}

/* =============================================================================
   MINI REALMS SCREEN
   ============================================================================= */

.mini-realms {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.mini-realm-card {
  padding: var(--space-2);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
}

.mini-realm-name {
  font-size: var(--font-size-xs);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.mini-realm-meta {
  display: flex;
  gap: var(--space-2);
}

.mini-realm-stat {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

/* =============================================================================
   MINI ACTIVITY SCREEN
   ============================================================================= */

.mini-activity {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.mini-activity-line {
  display: flex;
  align-items: baseline;
  gap: var(--space-1);
  font-size: 10px;
  line-height: 1.4;
}

.mini-activity-tick {
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  flex-shrink: 0;
}

.mini-activity-text {
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* =============================================================================
   V2 INTERACTIVE BASE CLASSES
   ============================================================================= */

.v2-input {
  font-family: var(--font-mono);
  font-size: var(--font-size-xs);
  color: var(--text-primary);
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-sm);
  padding: var(--space-1) var(--space-2);
  outline: none;
  transition: border-color 150ms ease;
  width: 100%;
  box-sizing: border-box;
}

.v2-input:focus {
  border-color: var(--member-color, var(--accent-primary));
}

.v2-input::placeholder {
  color: var(--text-muted);
}

.v2-btn {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-secondary);
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-sm);
  padding: var(--space-1) var(--space-2);
  cursor: pointer;
  white-space: nowrap;
  transition: border-color 150ms ease, color 150ms ease, background 150ms ease;
  flex-shrink: 0;
}

.v2-btn:hover {
  border-color: var(--member-color, var(--accent-primary));
  color: var(--text-primary);
}

.v2-btn:disabled,
.v2-btn.v2-btn-disabled {
  opacity: 0.4;
  cursor: default;
  pointer-events: none;
}

.v2-btn-primary {
  background: color-mix(in srgb, var(--member-color, var(--accent-primary)) 15%, var(--bg-tertiary));
  border-color: var(--member-color, var(--accent-primary));
  color: var(--member-color, var(--accent-primary));
}

.v2-btn-primary:hover {
  background: color-mix(in srgb, var(--member-color, var(--accent-primary)) 25%, var(--bg-tertiary));
}

.v2-textarea {
  font-family: var(--font-mono);
  font-size: var(--font-size-xs);
  color: var(--text-primary);
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-sm);
  padding: var(--space-2);
  outline: none;
  resize: vertical;
  min-height: 60px;
  max-height: 120px;
  width: 100%;
  box-sizing: border-box;
  transition: border-color 150ms ease;
}

.v2-textarea:focus {
  border-color: var(--member-color, var(--accent-primary));
}

.v2-textarea::placeholder {
  color: var(--text-muted);
}

/* =============================================================================
   V2 HOME SCREEN
   ============================================================================= */

.v2-home {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  padding: var(--space-3);
}

.v2-home-profile {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: var(--space-3);
}

.v2-home-avatar {
  width: 31.8%;
  aspect-ratio: 1 / 1.618;
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2em;
  font-weight: 700;
  color: var(--bg-primary);
  background: var(--accent-primary);
  flex-shrink: 0;
}

/* Avatar member color classes for v2 home */
.v2-home-avatar.member-love { background: var(--color-love); }
.v2-home-avatar.member-joy { background: var(--color-joy); color: #1a1a1a; }
.v2-home-avatar.member-peace { background: var(--color-peace); color: #1a1a1a; }
.v2-home-avatar.member-grace { background: var(--color-grace); }
.v2-home-avatar.member-hope { background: var(--color-hope); color: #1a1a1a; }
.v2-home-avatar.member-faith { background: var(--color-faith); color: #1a1a1a; }

.v2-home-profile-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-home-name {
  font-size: var(--font-size-lg);
  font-weight: 700;
  color: var(--text-primary);
}

.v2-home-headline {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  cursor: pointer;
  padding: 2px 0;
}

.v2-home-headline:hover {
  color: var(--text-primary);
}

.v2-home-headline-placeholder {
  color: var(--text-muted);
  font-style: italic;
}

.v2-home-headline-input {
  font-size: var(--font-size-sm);
  width: 100%;
}

.v2-home-bio {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  line-height: 1.5;
}

.v2-home-bio p {
  margin: 0.3em 0;
}

.v2-home-bio strong {
  color: var(--text-primary);
}

.v2-home-focus {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: var(--space-1) var(--space-3);
  background: color-mix(in srgb, var(--accent-primary) 8%, transparent);
  border-radius: var(--radius-pill);
}

.v2-home-focus-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-primary);
  flex-shrink: 0;
  animation: home-focus-pulse 2s ease-in-out infinite;
}

.v2-home-focus-text {
  font-size: var(--font-size-xs);
  color: var(--accent-primary);
  font-weight: 500;
}

.v2-home-no-focus {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  font-style: italic;
}

.v2-home-stats {
  display: flex;
  gap: var(--space-1);
}

.v2-home-section {
  width: 100%;
  padding: 0 var(--space-2);
}

.v2-home-contacts {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-home-contact {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: 4px var(--space-1);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: background 0.12s ease;
}

.v2-home-contact:hover {
  background: var(--bg-hover, rgba(255, 255, 255, 0.05));
}

.v2-home-contact-name {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.v2-home-contact-badge {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--accent-primary);
  background: color-mix(in srgb, var(--accent-primary) 10%, transparent);
  padding: 0 4px;
  border-radius: var(--radius-sm);
  flex-shrink: 0;
}

.v2-home-token-total {
  font-size: var(--font-size-xs);
  font-family: var(--font-mono);
  color: var(--accent-primary);
  font-weight: 600;
  margin-bottom: var(--space-1);
}

.v2-home-token-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  font-size: var(--font-size-xs);
  padding: 2px 0;
}

.v2-home-token-quest {
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.v2-home-token-value {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--accent-primary);
  flex-shrink: 0;
}

/* =============================================================================
   V2 QUEST SCREEN
   ============================================================================= */

.v2-quest {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-quest-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  margin-bottom: var(--space-1);
}

.v2-quest-header .mini-section-label {
  margin-bottom: 0;
}

.v2-quest-create-form {
  display: flex;
  gap: var(--space-1);
  margin-bottom: var(--space-2);
  padding: var(--space-2);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
}

.v2-quest-create-form .v2-input {
  flex: 1;
  min-width: 0;
}

.v2-quest-actions {
  display: flex;
  gap: var(--space-1);
  margin-top: 2px;
  padding-top: 2px;
}

/* =============================================================================
   V2 CHAT SCREEN
   ============================================================================= */

.v2-chat {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
}

.v2-chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  padding-bottom: var(--space-2);
  border-bottom: 1px solid var(--border-subtle);
  margin-bottom: var(--space-2);
  flex-shrink: 0;
}

.v2-chat-realm-name {
  font-size: var(--font-size-xs);
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.v2-chat-msg-count {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  flex-shrink: 0;
}

.v2-chat-messages {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  min-height: 0;
}

.v2-chat-messages::-webkit-scrollbar {
  width: 3px;
}

.v2-chat-messages::-webkit-scrollbar-track {
  background: transparent;
}

.v2-chat-messages::-webkit-scrollbar-thumb {
  background: var(--border-primary);
  border-radius: 2px;
}

.v2-chat-input-row {
  display: flex;
  gap: var(--space-1);
  padding-top: var(--space-2);
  border-top: 1px solid var(--border-subtle);
  flex-shrink: 0;
  margin-top: auto;
}

.v2-chat-input {
  flex: 1;
  min-width: 0;
}

.v2-chat-plus-btn {
  width: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-1);
  font-weight: 700;
  font-size: 14px;
}

.v2-chat-action-menu {
  position: relative;
  display: flex;
  gap: var(--space-1);
  padding: var(--space-2);
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-1);
  flex-shrink: 0;
}

.v2-quest-selector {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  padding: var(--space-2);
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-1);
  flex-shrink: 0;
}

.v2-quest-selector .mini-section-label {
  margin-bottom: var(--space-1);
}

.v2-quest-selector-item {
  text-align: left;
  width: 100%;
}

/* =============================================================================
   V2 PROOF SCREEN
   ============================================================================= */

.v2-proof {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.v2-proof-header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding-bottom: var(--space-2);
  border-bottom: 1px solid var(--border-subtle);
}

.v2-proof-title {
  font-size: 10px;
  font-weight: 700;
  color: var(--accent-primary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.v2-proof-quest-title {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.v2-proof-close {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  font-size: 10px;
  flex-shrink: 0;
}

.v2-proof-narrative {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-proof-narrative-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.v2-proof-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.v2-proof-view-toggle {
  font-size: 9px;
  padding: 1px 6px;
}

/* Markdown content area (scrollable, constrained height) */
.v2-proof-narrative-content {
  max-height: 200px;
  overflow-y: auto;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-sm);
  padding: var(--space-2);
}

.v2-proof-narrative-content::-webkit-scrollbar {
  width: 3px;
}

.v2-proof-narrative-content::-webkit-scrollbar-track {
  background: transparent;
}

.v2-proof-narrative-content::-webkit-scrollbar-thumb {
  background: var(--border-primary);
  border-radius: 2px;
}

/* Rendered markdown - style headings, lists, images inline */
.v2-proof-narrative-rendered {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  line-height: 1.5;
}

.v2-proof-narrative-rendered h1,
.v2-proof-narrative-rendered h2,
.v2-proof-narrative-rendered h3 {
  font-size: var(--font-size-xs);
  font-weight: 700;
  color: var(--text-primary);
  margin: var(--space-2) 0 var(--space-1);
  letter-spacing: 0.02em;
}

.v2-proof-narrative-rendered h1 { font-size: 13px; }
.v2-proof-narrative-rendered h2 { font-size: 12px; }
.v2-proof-narrative-rendered h3 { font-size: 11px; }

.v2-proof-narrative-rendered p {
  margin: var(--space-1) 0;
}

.v2-proof-narrative-rendered ul,
.v2-proof-narrative-rendered ol {
  padding-left: var(--space-4, 16px);
  margin: var(--space-1) 0;
}

.v2-proof-narrative-rendered li {
  margin: 2px 0;
}

.v2-proof-narrative-rendered strong {
  color: var(--text-primary);
  font-weight: 700;
}

.v2-proof-narrative-rendered em {
  font-style: italic;
}

/* Embedded images in narrative */
.v2-proof-narrative-rendered img {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border-subtle);
  margin: var(--space-2) 0;
  display: block;
}

/* Video placeholder (rendered as img alt text) */
.v2-proof-narrative-rendered video {
  max-width: 100%;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border-subtle);
  margin: var(--space-2) 0;
}

/* Raw markdown view */
.v2-proof-narrative-raw {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-secondary);
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  margin: 0;
}

.v2-proof-narrative-placeholder {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  font-style: italic;
}

/* Artifact image previews in grid */
.v2-proof-artifact-img {
  width: 100%;
  height: 36px;
  object-fit: cover;
  border-radius: 2px;
}

.v2-proof-artifact-video {
  color: var(--accent-primary);
}

.v2-proof-artifacts {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-proof-artifacts-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.v2-proof-file-count {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.v2-proof-artifact-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
  gap: var(--space-1);
}

.v2-proof-artifact-thumb {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  padding: var(--space-1);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-sm);
  position: relative;
  overflow: hidden;
}

.v2-proof-artifact-icon {
  font-family: var(--font-mono);
  font-size: 14px;
  color: var(--text-tertiary);
}

.v2-proof-artifact-name {
  font-size: 9px;
  color: var(--text-secondary);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  width: 100%;
}

.v2-proof-artifact-size {
  font-size: 8px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.v2-proof-artifact-remove {
  position: absolute;
  top: 1px;
  right: 1px;
  width: 14px;
  height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  font-size: 8px;
  opacity: 0.5;
}

.v2-proof-artifact-remove:hover {
  opacity: 1;
}

.v2-proof-actions {
  display: flex;
  gap: var(--space-2);
  padding-top: var(--space-2);
  border-top: 1px solid var(--border-subtle);
}

.v2-proof-actions .v2-btn {
  flex: 1;
}

.v2-proof-no-draft {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  font-style: italic;
  padding: var(--space-2) 0;
}

.v2-proof-submitted {
  border-top: 1px solid var(--border-subtle);
  padding-top: var(--space-2);
}

.v2-proof-submitted-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-xs);
  padding: 2px 0;
}

.v2-proof-submitted-quest {
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.v2-proof-submitted-value {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--accent-primary);
  flex-shrink: 0;
}

/* =============================================================================
   V2 FILES SCREEN (Finder-style file browser)
   ============================================================================= */

.v2-files {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  padding: var(--space-1) 0;
}

.v2-files-header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
}

.v2-files-header .mini-section-label {
  margin-bottom: 0;
}

.v2-files-count {
  font-size: 11px;
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.v2-files-section {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.v2-files-section-label {
  font-size: 10px;
  font-family: var(--font-mono);
  font-weight: 600;
  color: var(--text-tertiary);
  letter-spacing: 0.05em;
  text-transform: uppercase;
  padding-bottom: 4px;
  border-bottom: 1px solid var(--border-subtle);
  margin-bottom: 2px;
}

/* File card — each row is a horizontal strip: thumbnail | info | action */
.v2-file-card {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: 6px 8px;
  border-radius: 6px;
  cursor: default;
  transition: background 0.12s ease;
}

.v2-file-card:hover {
  background: var(--bg-hover);
}

.v2-file-clickable {
  cursor: pointer;
}

.v2-file-clickable:hover {
  background: var(--bg-active, var(--bg-hover));
}

/* Thumbnail square */
.v2-file-thumb {
  width: 40px;
  height: 40px;
  flex-shrink: 0;
  border-radius: 5px;
  overflow: hidden;
  background: var(--bg-tertiary);
  display: flex;
  align-items: center;
  justify-content: center;
}

.v2-file-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.v2-file-thumb-icon {
  font-size: 18px;
  color: var(--text-muted);
}

/* Info block — name + metadata */
.v2-file-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.v2-file-name {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.v2-file-meta {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Action buttons */
.v2-file-action {
  flex-shrink: 0;
  font-size: 10px;
  font-family: var(--font-mono);
  padding: 2px 8px;
  border-radius: 4px;
  border: 1px solid var(--border-subtle);
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  transition: background 0.12s, border-color 0.12s;
}

.v2-file-action:hover {
  background: var(--bg-hover);
  border-color: var(--text-muted);
}

.v2-file-recalled-badge {
  flex-shrink: 0;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  padding: 2px 6px;
}

.v2-files-empty {
  color: var(--text-muted);
  font-size: 12px;
  font-style: italic;
  padding: var(--space-4) 0;
  text-align: center;
}

/* =============================================================================
   V2 REALMS SCREEN
   ============================================================================= */

.v2-realms {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.v2-realm-card {
  padding: var(--space-2);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.v2-realm-name-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  cursor: pointer;
  transition: color 150ms ease;
}

.v2-realm-name-row:hover .v2-realm-edit-hint {
  opacity: 1;
}

.v2-realm-name {
  font-size: var(--font-size-xs);
  font-weight: 600;
  color: var(--text-primary);
}

.v2-realm-edit-hint {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-tertiary);
  opacity: 0;
  transition: opacity 150ms ease;
}

.v2-realm-edit-row {
  display: flex;
  gap: var(--space-1);
}

.v2-realm-alias-input {
  flex: 1;
}

.v2-realm-meta {
  display: flex;
  gap: var(--space-2);
}

.v2-realm-actions {
  display: flex;
  gap: var(--space-1);
  padding-top: var(--space-1);
}

/* =============================================================================
   V2 GRATITUDE SECTION (below proof folder messages in chat)
   ============================================================================= */

.v2-gratitude-section {
  padding: 6px 8px;
  margin: 4px 0;
  border-left: 3px solid var(--accent-secondary, #9b59b6);
  background: rgba(155, 89, 182, 0.08);
  border-radius: 4px;
}

.v2-gratitude-row {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 3px 0;
  font-size: var(--font-size-xs);
}

.v2-gratitude-member {
  font-weight: 600;
  color: var(--text-secondary);
}

.v2-gratitude-duration {
  opacity: 0.7;
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
}

.v2-btn-gratitude {
  background: var(--accent-secondary, #9b59b6);
  color: white;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-family: var(--font-mono);
  border: none;
  cursor: pointer;
  margin-left: auto;
  transition: opacity 150ms ease;
}

.v2-btn-gratitude:hover {
  opacity: 0.85;
}

/* =============================================================================
   SCENARIO PICKER - Full-screen grid of available Lua scenarios
   ============================================================================= */

.scenario-picker {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  padding: 48px 32px;
  background: var(--bg-primary);
  overflow-y: auto;
}

.scenario-picker-header {
  text-align: center;
  margin-bottom: 24px;
}

.scenario-picker-title {
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 8px;
  letter-spacing: -0.02em;
}

.scenario-picker-subtitle {
  font-size: var(--font-size-base);
  color: var(--text-muted);
  margin: 0;
}

.scenario-picker-search-row {
  width: 100%;
  max-width: 480px;
  margin-bottom: 16px;
}

.scenario-picker-search {
  width: 100%;
  box-sizing: border-box;
  font-family: var(--font-mono);
  font-size: var(--font-size-sm);
  color: var(--text-primary);
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-md, 8px);
  padding: 10px 14px;
  outline: none;
  transition: border-color 150ms ease;
}

.scenario-picker-search:focus {
  border-color: var(--accent-primary);
}

.scenario-picker-search::placeholder {
  color: var(--text-muted);
}

.scenario-picker-filters {
  display: flex;
  gap: 8px;
  margin-bottom: 24px;
}

.scenario-filter-btn {
  font-family: var(--font-mono);
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-pill, 20px);
  padding: 6px 16px;
  cursor: pointer;
  transition: border-color 150ms ease, color 150ms ease, background 150ms ease;
}

.scenario-filter-btn:hover {
  border-color: var(--accent-primary);
  color: var(--text-primary);
}

.scenario-filter-btn.active {
  background: color-mix(in srgb, var(--accent-primary) 15%, var(--bg-secondary));
  border-color: var(--accent-primary);
  color: var(--accent-primary);
  font-weight: 600;
}

.scenario-picker-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
  width: 100%;
  max-width: 1200px;
}

.scenario-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-md, 8px);
  padding: 16px;
  cursor: pointer;
  transition: border-color 200ms ease, background 200ms ease, transform 100ms ease;
}

.scenario-card:hover {
  border-color: var(--accent-primary);
  background: color-mix(in srgb, var(--accent-primary) 5%, var(--bg-secondary));
  transform: translateY(-1px);
}

.scenario-card-top {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

.scenario-card-name {
  font-size: var(--font-size-sm);
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  min-width: 0;
}

.scenario-card-badge {
  font-size: 9px;
  font-family: var(--font-mono);
  font-weight: 700;
  color: var(--accent-primary);
  background: color-mix(in srgb, var(--accent-primary) 12%, transparent);
  padding: 2px 6px;
  border-radius: var(--radius-sm, 4px);
  letter-spacing: 0.05em;
  flex-shrink: 0;
}

.scenario-card-desc {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  margin: 0;
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.scenario-picker-empty {
  grid-column: 1 / -1;
  text-align: center;
  padding: 32px;
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  font-style: italic;
}

/* =============================================================================
   COLUMN-SCOPED OVERLAYS
   Overlays render inside each member-column and fill that column only.
   ============================================================================= */

.member-column .markdown-preview-overlay,
.member-column .proof-narrative-overlay {
  position: absolute;
  inset: 0;
  padding: var(--space-2);
  z-index: 10;
  align-items: stretch;
}

.member-column .markdown-preview-dialog,
.member-column .proof-narrative-dialog {
  max-width: 100%;
  max-height: 100%;
  width: 100%;
  overflow: hidden;
}

.member-column .markdown-rendered img {
  max-width: 100%;
  height: auto;
}

.member-column .proof-narrative-rendered img {
  max-width: 100%;
  height: auto;
}

.member-column .proof-narrative-gallery-grid {
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
}

/* Image preview inside column overlay */
.member-column .image-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
}

.member-column .image-preview-img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: var(--radius-md);
}

/* =============================================================================
   CONTACT PROFILE OVERLAY
   ============================================================================= */

.v2-contact-profile-overlay {
  position: absolute;
  inset: 0;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-2);
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.v2-contact-profile-card {
  width: 100%;
  aspect-ratio: 1.618 / 1;
  max-height: 100%;
  overflow-y: auto;
  background: var(--bg-primary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.v2-contact-profile-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.v2-contact-profile-header .mini-section-label {
  margin-bottom: 0;
}

.v2-contact-profile-close {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  font-size: 10px;
  flex-shrink: 0;
}

.v2-contact-headline-readonly {
  cursor: default;
}

.v2-contact-headline-readonly:hover {
  color: var(--text-secondary);
}
